<!DOCTYPE html>
<html lang="en">
  <head>
    <title>⚐ Dumber</title>
    <meta charset="UTF-8">
    <meta http-equiv="cache-control" content="no-cache">
    <style>
      body { font-family: Univers, "Helvetica Neue", Helvetica, sans-serif;
        width: 720px; margin: auto; font-size: 16px; }
      code, pre { font-family: Menlo, Consolas, monospace; font-size: 14px; }
      a { color: #ff4040; text-decoration: none; }
      .def { background-color: #ff0; }
      .node { background-color: #8f8; }
      .param { background-color: #8ff; }
      .sample { margin-left: 2em; }
    </style>
  </head>
  <body>
    <h1>Dumber</h1>
    <p>Dumber is a simpler implementation of Bender intended to prototype
    dynamic rendering of components.</p>

    <section id="tests">
      <h2>Tests</h2>
      <p>These tests can be run directly in a browser.</p>
      <ol>
        <li><a href="tests/hello.html">Hello, world!</a>: display the text
        "Hello, world!"</li>
        <li><a href="tests/hello.svg">Hello, world!</a>: display the text
        "Hello, world!" but in SVG</li>
        <li><a href="tests/disappearer.html">Disappearer</a>: same as above but
        the content is immediately removed so nothing is displayed.</li>
        <li><a href="tests/insert.html">Insert</a>: insert a Dumber node in an
        existing document.</li>
        <li><a href="tests/title.html">Title setting and updating</a>: the title
        bar should read "Newest title". <strong>BUG</strong>: the last change is
        not shown.</li>
        <li><a href="tests/use.html">Nested use modified at runtime</a>: display
        A, B, C followed by - - - with 2 horizontal lines under each and = = =
        between the horizontal lines</li>
        <li><a href="tests/add.html">Adding and removing components</a>: display
        5 paragraphs: "This is a p.", "This is a q.", "Followed by a p.", "This
        one is added after rendering.", "Followed by a p."</li>
        <li><a href="tests/calculator.html">Calculator (inactive buttons)</a>:
        display a calculator and its buttons</li>
        <li><a href="tests/button.html">Button component</a>: display three
        buttons "OK", "Cancel", "Retry"; generate an alert when clicked.</li>
        <li><a href="tests/button_style.html">Button with style</a>: same but OK
        is bold and Cancel is semi-transparent.</li>
      </ol>
    </section>

    <section id="manual">
      <h2>Manual</h2>

      <section id="manual.start">
        <h3>Getting started</h3>
        <p>Using Dumber just requires including the <code>flexo.js</code> (the
        support library for Dumber) and <code>dumber.js</code> in the host
        document (<em>e.g.</em>, in <code>script</code> tags.) See for example
        the above test documents.</p>
      </section>

      <section id="manual.context">
        <h3>The context</h3>
        <p>The <em>context</em> is the document hosting Dumber nodes. The root
        of the document is a <code>context</code> element, which in turn has
        <code>component</code> or <code>app</code> child nodes. Rendering an
        application or a component in a target document is achieved by adding a
        <code>use</code> node for the desired component to the tree.</p>
        <p><code class="def">dumber.create_context(target)</code> creates a new
        context with a rendering target specified by <code
          class="param">target</code> (or the current document by default.)
        Rendered nodes will be appended to the given target. The
        <code class="param">context</code> root element is returned (not the
        context document itself, which can be accessed through the DOM
        <code>ownerDocument</code> property of any node in the document.) This
        element is actually a Bender component.</p>
      </section>

      <section id="manual.nodes">
        <h3>Dumber nodes</h3>
        <p>Nodes in the Dumber tree overload common DOM methods so that changes
        can be tracked and reflected after rendering was done. Component
        elements, such as the context root element, have a convenience method
        <code class="def">$(name, attributes, <em>contents</em>)</code> to
        create new nodes.</p>
        <ul>
          <li>The <code class="param">name</code> parameter may be qualified
          with a known namespace prefix (<code>html</code> or
          <code>xhtml</code>, <code>svg</code>, <code>xlink</code>,
          <code>xml</code>, <code>xmlns</code>; the Dumber namespace is used if
          there is no prefix) and may include an id prefixed by <code>#</code>
          and a list of class names prefixed by <code>.</code>. For example, the
          name string <code>html:div#calculator.calculator</code> describes an
          HTML <code>div</code> element with id <code>caculator</code> and class
          <code>calculator</code>, while <code>use</code> describes a Dumber
          <code>use</code> element. <strong>Note</strong>: id must come before
          classes.</li>
          <li>The <code class="param">attributes</code> parameters is an object
          which keys are attribute names and values attribute values. For
          example, <code>{ q: "app" }</code> sets the <code>q</code> attribute
          to <code>app</code> for the node being created. This parameter can be
          omitted. Note that a null or undefined value for an attribute will not
          set it.</li>
          <li>The following parameters (if any) are the contents of the node.
          Valid content is either a string, which creates a text node, and other
          nodes, usually created through the <code>context.$</code> method.</li>
        </ul>
        <p>Node manipulation is done through the DOM methods <code
          class="def">appendChild</code>, <code class="def">insertBefore</code>,
        and <code class="def">setAttribute</code>. Additionally, Dumber nodes
        have a <code class="def">_textContent(text)</code> method to replace
        setting the <code>textContent</code> property, which can still be read
        normally (and also be set, but changes will not cause the rendering to
        update.) Dumber nodes have an internal method <code class="def
          internal">_refresh(parent)</code> which will refresh the rendering for
        the parent of this node (which defaults to <code>parentNode</code> if
        not specified; the parameter is needed mostly for updates after a node
        has been removed from its parent.) It should not be necessary to call
        this method under normal circumstances.</p>
        <p>Since a Dumber tree may be modified at runtime, it can be serialized
        again through the <code class="def">_serialize()</code> method. This
        simply returns a text string of the XML serialization of the current
        state of the Dumber tree. This method is available on any node, so it
        may be used for instance for the main application or a given component
        rather than the full context.</p>

        <section id="manual.nodes.component">
          <h4>The component, app and context nodes</h4>
          <p>The <code class="node">component</code> node describes a Dumber
          component.  <code class="node">app</code> is synonymous with
          <code>component</code> and is provided to describe the main component
          of a Dumber application. <code class="node">context</code> is also a
          synonym and is used as the root of the Dumber tree (and as such should
          not be used elsewhere.) A component may have metadata, a view,
          scripts, watches, and sub-components. These are described by the
          following nodes:</p>
          <ul>
            <li><code class="node">desc</code> contains textual description for
            the component. This is used as metadata; for intance, it can be used
            to give hints at the usage of this component.</li>
            <li><code class="node">script</code> allows customizing the behavior
            of a component through Javascript.</li>
            <li><code class="node">title</code> contains the title of the
            component as plain text. This is used mostly as metadata, but gets
            rendered as the document title when it is the child of an
            <code>app</code> element which in turn is the child of a
            <code>context</code> root element.</li>
            <li><code class="node">use</code> creates a new instance of a
            component and renders it in this component's view (including in a
            <node>context</code> node; see below.) <code>use</code> nodes should
            appear as descendants of the <code>view</code> node of the
            component.</li>
            <li><code class="node">view</code> contains foreign nodes that will
            be rendered in the target document when this component is rendered.
            A component may have only one view; setting a new view automatically
            replaces the previous one.</li>
            <li><code class="node">watch</code> describes the behavior of the
            component in the face of changes in its properties and events it
            receives. See the section on watches below.</li>
          </ul>
        </section>

        <section id="manual.nodes.script">
          <h4>The script node</h4>
          <p>The <code class="node">script</code> node contains custom
          Javascript code. This code is executed when the node is first created
          or imported into the context and defines a special variable to access
          the <em>prototype</em> of the component that it is part of. It is
          therefor possible to overload the base component's methods as well as
          add new methods to that component.</p>
          <p>Inside a <code>script</code> node the <code
          class="param">prototype</code> variable is set to the prototype of the
          current component.</p>
        </section>

        <section id="manual.nodes.use">
          <h4>The use node</h4>
        </section>

        <section id="manual.nodes.view">
          <h4>The view and content nodes</h4>
        </section>

        <section id="manual.nodes.watch">
          <h4>The watch, get and set nodes</h4>
        </section>

      </section>

      <section id="manual.instances">
        <h3>Component and watch instances</h3>
        <p>Before a component can be rendered, it must be instantiated. Many
        instances of the same component may be created and rendered
        independently, maintaining their own state.</p>
      </section>

      <section id="manual.render-tree">
        <h3>Rendering a Dumber tree</h3>
        <p>A self-contained Dumber application tree can be rendered into any
        host document by simply creating a context with the host document as
        target, populating the tree, and having a <code>use</code> element as a
        child of the root element pointing to the main application component.
        Here is a simple HTML "Hello, world!" example being rendered in the body
        of the host document:</p>
        <pre class="sample">var context = dumber.create_context(document.body);
context.appendChild(
  context.$("component",
    context.$("view",
      context.$("html:p", "Hello, world!"))));
context.appendChild(context.$("use", { q: "component" }));</pre>
      </section>

      <section id="manual.render-component">
        <h3>Rendering a Dumber component in a document</h3>
        <p>Another use case is to render individual components into an existing
        document. The difference is that we render directly a component element
        into the given target, using the <code
          class="def">_render_in(target)</code> where <code
          class="param">target</code> is the parent DOM node where the content
        will be rendered. For example, to render a component in a
        <code>div</code> element with the id <code>here</code>:</p>
        <pre class="sample">var context = dumber.create_context(document);
context.appendChild(
  context.$("component",
    context.$("view",
      context.$("html:p.dumber", "But this is a Dumber component!"))));
context.querySelector("component")._render_in(document.getElementById("here"));</pre>
      </section>

    </section>

  </body>
</html>
