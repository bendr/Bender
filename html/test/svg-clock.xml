<component xmlns="http://bender.igel.co.jp" href="../lib/svg.xml">

  <!--
  <property name="palette" value='new flexo.Urn(["#ff6a4d", "#0b486b",
    "#5eb26b", "#774f38", "#f8ca00", "#9e0b46", "#a61416", "#222222",
    "#f8f9f0", "#4dbce9", "#06491d", "#f94179"])' select="$that"/>
  -->

  <property name="palette" select="$that">
    var palette = new flexo.Urn(["#ff6a4d", "#0b486b", "#5eb26b", "#774f38",
      "#f8ca00", "#9e0b46", "#a61416", "#222222", "#f8f9f0", "#4dbce9",
      "#06491d", "#f94179"]);
    bender.trace("%0: palette".fmt(this.url()));
    return palette;
  </property>


  <property name="fill" value="`palette.pick()"/>
  <property name="stroke" value="`palette.pick()"/>
  <property name="font-color" value="`palette.pick()"/>
  <property name="city" as="string" value=""/>

  <property name="offset" value="new Date().getTimezoneOffset() / 60"/>
  <property name="n"/>
  <property name="h" value="((`n / 3600000) % 24 - `offset) * 30"/>
  <property name="m" value="((`n / 60000) % 60) * 6"/>
  <property name="s" value="((`n / 1000) % 60) * 6"/>

  <view xmlns:svg="http://www.w3.org/2000/svg">
    <component id="tock" href="../lib/ticker.xml">
      <property name="rate-ms" value="0"/>
    </component>
    <component id="tick" href="../lib/ticker.xml"/>
    <attribute name="viewBox">-200 -200 400 400</attribute>
    <svg:g stroke="`stroke" stroke-linecap="round" stroke-width="4">
      <svg:circle r="180" fill="`fill"/>
      <svg:g id="minutes" stroke="`font\-color"/>
      <svg:text y="-40" fill="`font\-color" stroke="none" stroke-width="0.5"
        font-size="32" text-anchor="middle">`city</svg:text>
      <svg:g transform="rotate(-90)">
        <svg:line x1="80" transform="rotate(`h)"/>
        <svg:line x1="140" transform="rotate(`m)"/>
        <svg:line x1="140" transform="rotate(`s)" stroke-dasharray="10 10"/>
      </svg:g>
    </svg:g>
  </view>

  <watch>
    <get event="ready"><![CDATA[
      if (@minutes.appendChild) {
        for (var i = 0; i < 60; ++i) {
          @minutes.appendChild(flexo.$line({ y1: 170,
            y2: i % 5 == 0 ? 150 : 160, transform: "rotate(%0)".fmt(i * 6) }));
        }
      }
    ]]></get>
  <set select="@tick" property="rate-ms"
    value="flexo.random_int(3000, 12000)"/>
  </watch>

  <watch>
    <get select="@tock" event="tick"/>
    <set property="n" value="Date.now()"/>
  </watch>

</component>
