<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Bender | Example | Component Rendering | Target</title>
    <meta charset="UTF-8">
    <meta http-equiv="cache-control" content="no-cache">
    <link rel="stylesheet" href="../example.css">
    <script src="../../flexo.js"></script>
    <script src="../../bender.js"></script>
  </head>
  <body>
    <script src="../example.js"></script>
    <script>
"use strict";

var context = bender.create_context();
var main = context.appendChild(
    context.$("component",
      context.$("component", { id: "box-gradient" },
        context.$("view",
          context.$("target", { q: "defs", unique: "true" },
            context.$("svg:linearGradient#gradient", { y2: "100%", x2: "0%" },
              context.$("svg:stop", { offset: "0%", "stop-color": "#00e390" }),
              context.$("svg:stop", { offset: "100%",
                "stop-color": "#f79767" }))),
          context.$("svg:rect", { x: 10, y: 10, width: 80, height: 80,
            fill: "url(#gradient)" }))),
      context.$("view",
        context.$("svg:svg", { viewBox: "0 0 200 200" },
          context.$("svg:defs", { id: "defs" }),
          context.$("use", { href: "#box-gradient" }),
          context.$("use", { href: "#box-gradient",
            transform: "translate(100) rotate(90, 50, 50)" }),
          context.$("use", { href: "#box-gradient",
            transform: "translate(0, 100) rotate(270, 50, 50)" }),
          context.$("use", { href: "#box-gradient",
            transform: "translate(100, 100) rotate(180, 50, 50)" })))));
var use = context.appendChild(context.$("use"));
use._component = main;

flexo.listen(context.ownerDocument, "@refreshed", function (e) {
  if (e.instance.use === use) {
    setTimeout(function () {
      var defs = document.querySelector("defs");
      example.ok(defs.childNodes.length === 1 &&
        defs.childNodes[0].id === "gradient" &&
        !defs.id);
    }, 0);
  }
});

    </script>
  </body>
</html>
