<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Host test</title>
    <meta charset="UTF-8">
    <style>
      body { font-family: "Helvetica Neue", Helvetica, sans-serif; }
    </style>
  </head>
  <body>
    <form onsubmit="writeFile(event)">
      <textarea name="text"></textarea>
      <br>
      <input type="submit" value="Write file">
    </form>
    <p></p>
    <script>

      var textarea = document.querySelector("textarea");
      var p = document.querySelector("p");
      var path = "/tmp/t";

      // Read the file
      var req = new XMLHttpRequest();
      req.open("GET", "http://127.0.0.1:8910/fs/readFile?filename=" + path);
      req.onreadystatechange = function()
      {
        if (req.readyState === 4) {
          if (req.status === 200) {
            var result = JSON.parse(req.responseText);
            if (result[0]) {
              p.textContent = "readFile error: " + result[0].code;
            } else {
              textarea.value = result[1];
            }
          } else {
            p.textContent = "readFile error, status " + req.status + ": " +
              req.responseText;
          }
        }
      };
      req.send("");

      function writeFile(e)
      {
        e.preventDefault();
        // Write to the file
        var req = new XMLHttpRequest();
        req.open("PUT", "http://127.0.0.1:8910/fs/writeFile?filename=" + path);
        req.onreadystatechange = function()
        {
          if (req.readyState === 4) {
            if (req.status === 200) {
              var result = JSON.parse(req.responseText);
              if (result[0]) {
                p.textContent = "writeFile error: " + result[0].code;
              } else {
                p.textContent = "OK";
              }
            } else {
              p.textContent = "writeFile error, status " + req.status + ": " +
                req.responseText;
            }
          }
        };
        req.send(textarea.value);
      }

    </script>
  </body>
</html>

