<app xmlns="http://bender.igel.co.jp" xmlns:b="http://bender.igel.co.jp/b"
  xmlns:e="http://bender.igel.co.jp/e"
  xmlns:html="http://www.w3.org/1999/xhtml">

  <title>Watch/XMLHttpRequest</title>

  <stylesheet>
    input[type=text] { width: 24em; }
  </stylesheet>

  <view>
    <use href="../lib/textinput.xml#textinput" id="url" e:submit="Go"
      b:autofocus="true">URL:</use>
    <html:pre id="response"/>
    <html:p id="error"/>
  </view>

  <watch>
    <get view="url" event="@value"/>
    <set value="e">
      this.xhr(e.input.value);
    </set>
    <set view="response" e:return=""/>
    <set view="error" e:return=""/>
  </watch>

  <watch>
    <get event="@xhr-success"/>
    <set view="response" value="req">
      return req.responseText || req.responseXML;
    </set>
  </watch>

  <watch>
    <get event="@xhr-error"/>
    <set view="error" value="req">
      return "Error: " + req.responseText || req.responseXML;
    </set>
  </watch>

</app>
