<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Uninstance 2: Electric Boogaloo</title>
    <meta charset="UTF-8">
    <style>
body {
  font-family: "Avenir Next", sans-serif;
}

div {
  border: solid thin #f80;
  padding: 1em;
}

div.contents {
  border-color: #08f;
}
    </style>
    <meta http-equiv="cache-control" content="no-cache">
    <script src="../../html/src/flexo.js"></script>
  </head>
  <body>
    <script src="core.js"></script>
    <script src="render.js"></script>
    <script>
"use strict";

/*
Component.on_handlers.init = function () {
  console.log("on:init", this);
};

Component.on_handlers.instantiate = function (view) {
  console.log("on:instantiate", this, view);
};

Component.on_handlers.render = function (stack) {
  console.log("on:render", this, stack);
};
*/

var env = bender.environment();

/*
var A = env.component().id("A")
  .view(env.$div({ "class": "contents" }, env.$p("Hello from A")));
var A_ = A.render_instance(document.body);
*/

var C = env.$("component#C", env.$view(
      env.$div(env.$text({ id: "text" }, "And this is a C."))));
var B = env.$("component#B", env.$view(
      env.$div(
        env.$component({ id: "C1", prototype: C }),
        env.$p("This is a B."),
        env.$component({ id: "C2", prototype: C }))));
var A = env.$("component#A", env.$view(
      env.$p("This is A."),
      env.$div({ "class": "contents" },
        env.$component({ id: "B1", prototype: B }),
        env.$component({ id: "B2", prototype: B }))));
var A_ = A.render_instance(document.body);


setTimeout(function () {
  // A.scope.view.add_child(flexo.$p("And A again!"));
  // return;
  A_.scope_of(A)["@B1"].scope_of(B)["@this"].scope.view.children[0]
    .add_child(flexo.$p("One more B"));
  console.log("One more B?");
}, 1000);


    </script>
  </body>
</html>
