<app xmlns="http://bender.igel.co.jp" xmlns:b="http://bender.igel.co.jp/b"
  xmlns:svg="http://www.w3.org/2000/svg" b:test="true">
  <title>SVG Button component test</title>

  <component id="svg-button" b:enabled="true">
    <view>
      <svg:g id="_enabled">
        <content id="enabled"/>
      </svg:g>
      <svg:g id="_pushed">
        <content id="pushed"/>
      </svg:g>
      <svg:g id="_disabled">
        <content id="disabled"/>
      </svg:g>
    </view>

    <watch>
      <get property="enabled"/>
      <set>
        this.views._enabled.setAttribute("display", value ? "" : "none");
        this.views._pushed.setAttribute("display", "none");
        this.views._disabled.setAttribute("display", value ? "none" : "");
      </set>
    </watch>

    <watch>
      <get view="_enabled" dom-event="mousedown"/>
      <get view="_enabled" dom-event="touchstart"/>
      <set>
        this.views._enabled.setAttribute("display", "none");
        this.views._pushed.setAttribute("display", "");
      </set>
    </watch>

    <watch>
      <get view="_pushed" dom-event="mouseup"/>
      <get view="_pushed" dom-event="touchend"/>
      <set>
        this.views._enabled.setAttribute("display", "");
        this.views._pushed.setAttribute("display", "none");
        setTimeout((function() { bender.notify(this, "@pushed"); }).bind(this),
          0);
      </set>
    </watch>

    <watch>
      <get dom-event="mouseup"/>
      <get dom-event="touchend"/>
      <set>
        this.views._enabled.setAttribute("display", "");
        this.views._pushed.setAttribute("display", "none");
      </set>
    </watch>
  </component>

  <view>
    <component ref="svg-button" id="button">
      <content ref="enabled">
        <svg:rect width="100" height="100" rx="10" ry="10" fill="#08f"/>
      </content>
      <content ref="pushed">
        <svg:rect width="100" height="100" rx="10" ry="10" fill="#f80"/>
      </content>
      <content ref="disabled">
        <svg:rect width="100" height="100" rx="10" ry="10" fill="#ff4040"/>
      </content>
    </component>
  </view>

  <watch>
    <get view="button" event="@pushed">
      alert("button was pushed!");
    </get>
  </watch>

</app>
