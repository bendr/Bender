<app xmlns="http://bender.igel.co.jp" xmlns:html="http://www.w3.org/1999/xhtml">
  <title>Canvas (custom view controller)</title>
  <stylesheet>
    .canvas-frame { height: 480px; width: 640px; }
    canvas { border: solid thin black; position: absolute; }
  </stylesheet>
  <script href="canvas.js"/>

  <update>
    <get view="canvas-points" dom-event="mousedown"/>
    <get view="canvas-points" dom-event="touchstart"/>
    <set controller="">
      controller.start_drawing(event);
    </set>
    <update>
      <get dom-event="mousemove"/>
      <get view="canvas-points" dom-event="touchmove"/>
      <set controller="">
        controller.keep_drawing(event);
      </set>
    </update>
    <update once="true">
      <get dom-event="mouseup"/>
      <get view="canvas-points" dom-event="touchend"/>
      <set controller="">
        controller.stop_drawing(event);
      </set>
    </update>
  </update>

  <controller instance-of="canvas_controller">
    <connect outlet="curves" target="canvas-curves"/>
    <connect outlet="points" target="canvas-points"/>
    <update>
      <get event="@rendered" handler="rendered"/>
    </update>
  </controller>

  <view>
    <html:p>Draw in the canvas below:</html:p>
    <html:div class="canvas-frame">
      <html:canvas width="640" height="480" id="canvas-curves"/>
      <html:canvas width="640" height="480" id="canvas-points"/>
    </html:div>
  </view>
</app>
