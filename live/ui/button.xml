<component xmlns="http://bender.igel.co.jp">

  <property name="class" value="ui-button"/>
  <property name="enabled" type="boolean" value="true"/>
  <property name="stop-propagation" type="boolean" value="false"/>
  <property name="delay" type="number" value="50"/>
  <property name="down" type="boolean" value="false"/>
  <property name="down-class"/>

  <view xmlns:html="http://www.w3.org/1999/xhtml">
    <html:span aria-role="button"
      class="{class} {down-class} { {enabled} ? '' : 'disabled' }">
      <content/>
    </html:span>
  </view>

  <watch>
    <get view="$root" dom-event="mousedown" when="this._properties.enabled"/>
    <get view="$root" dom-event="touchstart" when="this._properties.enabled"/>
    <set instance="$self" property="down">
      value.preventDefault();
      if (this._properties["stop-propagation"]) {
        value.stopPropagation();
      }
      return true;
    </set>
  </watch>

  <watch>
    <get view="$document" dom-event="mouseup" when="this._properties.down"/>
    <get view="$document" dom-event="touchend" when="this._properties.down"/>
    <set instance="$self" property="down" value="false"/>
    <set instance="$self" event="@pushed"/>
  </watch>

  <watch>
    <get view="$document" dom-event="mousemove" when="this._properties.down"/>
    <get view="$document" dom-event="touchmove" when="this._properties.down"/>
    <set instance="$self" property="down" value="false"/>
  </watch>

  <watch>
    <get instance="$self" property="down"/>
    <set instance="$self" property="down-class" delay="{delay}">
      return value ? "ui--down" : "";
    </set>
  </watch>

</component>
