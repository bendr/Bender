<component xmlns="http://bender.igel.co.jp">
  <link rel="stylesheet" href="edit.css"/>
  <property name="grid-size" as="number" value="16"/>
  <property name="grid-url"/>
  <view xmlns:html="http://www.w3.org/1999/xhtml">
    <html:div class="work-area" style="background-image:`(grid-url);"/>
    <component href="tool-bar.xml"/>
  </view>
  <watch>
    <get property="grid-size"/>
    <set property="grid-url">
      var canvas = scope.$document.createElement("canvas");

      canvas.width = canvas.size = this.properties["grid-size"];
      canvas.height = this.properties["grid-size"];
      var context = canvas.getContext("2d");
      context.beginPath();
      context.moveTo(0, 0.5);
      context.lineTo(this.properties["grid-size"], 0.5);
      context.moveTo(0.5, 0);
      context.lineTo(0.5, this.properties["grid-size"]);
      context.strokeStyle = "#bfdfff";
      context.lineWidth = 0.5;
      context.stroke();

      /*
      var sz = this.properties["grid-size"];
      canvas.width = canvas.height = sz * 2;
      var context = canvas.getContext("2d");
      context.fillStyle = "#bfdfff";
      context.fillRect(0, 0, sz, sz);
      context.fillRect(sz, sz, sz, sz);
      */

      return "url(%0)".fmt(canvas.toDataURL("image/png"));
    </set>
  </watch>
</component>
