exports.PATTERNS =
[
  [/^\/live$/, { GET: live }],
  [/^\/run$/, { GET: run }],
];

function live(tr)
{
  tr.serve_html(html_page({ lang: "en", title: "Bender LIVE!" },
        $$stylesheet("live.css") + $$stylesheet("misc/codemirror.css") +
        $$script("flexo.js") + $$script("bender.js") +
        $$script("misc/codemirror.js") + $$script("misc/xmlpure.js"),
        $textarea({ id: "editor", cols: 80, autofocus: true }) +
        $$script("live.js")));
}

// Load the base application
function run(tr)
{
  var page = "<!DOCTYPE html>\n" +
    $html({ lang: "en" },
      $head(
        $title("Bender"),
        $style("html, body { height: 100%; }\n",
          "body, svg { margin: 0; padding: 0; }"),
        $script({ src: "flexo.js" }),
        $script({ src: "bender.js" }),
        $script({ src: "run.js" }),
      $body(
        $script("open_url(get_args({ debug: 0 }));"))));
  transaction.serve_html(page);
}
